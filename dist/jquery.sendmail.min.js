/**
 * jQuery.sendMail
 * Version: 2.0.5
 * Repo: https://github.com/WahaWaher/sendmail-js
 * Author: Sergey Kravchenko
 * Contacts: wahawaher@gmail.com
 * License: MIT
 */

!function(o){function d(t,e){this.form=t,this.init(e)}var a,r={url:"mail/sendmail.php",reset:!0,freeze:0},t=d.prototype;t.init=function(t){var e=this,n=o(e.form);!0!==e.inited&&"FORM"==e.form.tagName&&(e.defaults=o.extend(!0,{},r,o.fn.sendMail.defaults),e.options=t||{},e.dataOptions=n.data("sendmail")||{},e.settings=o.extend(!0,{},e.defaults,e.options,e.dataOptions),n.trigger("beforeInit.sml",[e,e.form]),e.nsid=a.getRndNum(1e4,99999),e.stop=!1,n.addClass("sendmail-form").on("submit.sml-"+e.nsid,function(){return e.send.call(e),!1}),e.inited=!0,n.trigger("afterInit.sml",[e,e.form]))},t.send=function(){var n,a=this,t=a.form,r=o(t),i=a.settings;a.inited&&!a.stop&&(a.stop=!0,r.trigger("beforeSend.sml",[a,a.form]),r.find('input[type="file"]').length?((n={data:new FormData(t),ajaxProcData:!1,ajaxContType:!1}).data.append("js","on"),a.addData&&o.each(a.addData,function(t,e){n.data.append(t,e)}),window.FormData||r.off("submit.sml-"+a.nsid).trigger("submit")):(n={data:r.serialize()+"&js=on",ajaxProcData:!0,ajaxContType:"application/x-www-form-urlencoded; charset=UTF-8"},a.addData&&(n.data+="&"+o.param(a.addData))),o.ajax({type:"POST",url:i.url,data:n.data,processData:n.ajaxProcData,contentType:n.ajaxContType,success:function(t,e,n){1==n.getResponseHeader("sendmail")?(a.pullFreeze(),r.trigger("success.sml",[a,a.form,t]),i.reset&&r.trigger("reset")):r.trigger("serverError.sml",[a,a.form,t]),r.trigger("afterSend.sml",[a,a.form,t])},error:function(t){a.pullFreeze(),r.trigger("afterSend.sml",[a,a.form,t]),r.trigger("ajaxError.sml",[a,a.form,t])}}))},t.pullFreeze=function(t){var e=this;setTimeout(function(){e.stop=!1},t||this.settings.freeze)},t.destroy=function(){var t=this,e=t.form;t.inited&&(o(e).removeClass("sendmail-form").off("submit.sml-"+t.nsid),delete e.SendMail)},t.reinit=function(t){var e=this,n=o(e.form),a="object"==typeof t&&0!=Object.keys(t).length?t:o.extend(!0,{},e.settings);e.destroy(),n.sendMail(a)},a={getRndNum:function(t,e){return Math.round(t-.5+Math.random()*(e-t+1))}},o.fn.sendMail=function(){var a="SendMail",n=arguments,r=n[0];function i(t,e,n){return t[a]instanceof d&&e in t[a]&&t[a][e].apply(t[a],Array.prototype.slice.call(n,1))}function s(t,e){if(!(t[a]instanceof d))return new d(t,e)}return o.each(this,function(t,e){"object"==typeof r||void 0===r?e[a]=s(e,r):"init"!==r&&"reinit"!==r||e[a]?i(e,r,n):e[a]=s(e,n[1])}),this},o.fn.sendMail.prototype=d.prototype,o.fn.sendMail.defaults=r}(jQuery);